- defaults:
    stdin: false
    link:
      relink: true

- clean: ['~']

- shell:
    - mkdir ~/.ssh || touch ~/.ssh/known_hosts
    - [ssh-keyscan -H github.com >> ~/.ssh/known_hosts, adding github to known hosts]

- link:
    ~/.config/brewfile/Brewfile: Brewfile

    # Git:
    ~/:
      glob: true
      path: git/*
      prefix: '.git'

    # Tools:
    ~/.config/iterm-settings: config/iterm-settings

    # ~/.vim: vim
    # ~/.vimrc: vimrc
- shell:
    - description: install homebrew
      command: echo | /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
      stdout: true
      stdin: true

- brewfile:
    file: Brewfile
    stdout: true
    stderr: true
    include: ['tap', 'brew', 'cask', 'mas']

- shell:
    - [touch ~/.hushlogin] # supress last login info
    - description: generate ssh key if not exists
      command: >
        [ -f "$HOME/.ssh/id_rsa" ] ||
        ssh-keygen -f "$HOME/.ssh/id_rsa" -qt rsa -b 4096 -N ""
        -C $(git config --global --get user.email)
    - [sudo chsh -s $(which zsh), Making zsh the default shell]
    - [git submodule update --init --recursive, Installing submodules]
